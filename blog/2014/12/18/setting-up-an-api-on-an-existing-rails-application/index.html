
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Setting Up An API On An Existing Rails Application — Christina Leuci</title>
  <meta name="author" content="Christina Leuci"/>

  
  <meta name="description" content="I’m a full-stack ruby dev from New Jersey now working in New York. I build apps and products, such as Pelicula Picker, an app that rates how well a &hellip;"/>
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  
  <link rel="canonical" href="http://ChristinaLeuci.github.io/blog/2014/12/18/setting-up-an-api-on-an-existing-rails-application"/>
  <link href="/favicon.png" rel="icon"/>
  <link href="/stylesheets/bootstrap.min.css" rel="stylesheet" type="text/css"/>
  <link href="/stylesheets/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"/>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css"/>
  <link href="/atom.xml" rel="alternate" title="Christina Leuci" type="application/atom+xml"/>
  <script src="//cdn.jsdelivr.net/jquery/1.11/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.min.js"><\/script>')</script>
  
  <style id="search-style"></style>
  

  

  

</head>

<body >
  
  <header role="banner" class="hidden">
  <h1><a href="/">Christina Leuci</a></h1>


  <h2>I pity the &#8220;foo&#8221;</h2>


</header>
  
  <nav class="navbar navbar-static-top" role="navigation"><div class="nav-collapse collapse">
<ul class="nav subscription pull-right" data-subscription="rss">
  <li><a href="/atom.xml" rel="alternate" data-type="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form class="navbar-search pull-right" action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sites" value="ChristinaLeuci.github.io" />
    <input type="hidden" name="q" value="site:ChristinaLeuci.github.io" />
    <input class="search search-query" type="text" id="q" name="q"
      placeholder="Search"
      autocomplete="off" />
  </fieldset>
  
  <ul class="dropdown-menu" role="listbox" id="search_listbox">
    
    <li data-index="setting up an api on an existing rails application hey y&#39;all it&amp;rsquo;s been a long time! life has been a bit busy at the moment and i&amp;rsquo;ll write a blog all about that in the non-technical session asap.

today i&amp;rsquo;m going to talk about setting up your current rails application with an api. this is assuming that you have a working rails application, preferably with data to see in the browser when you have it up and running through the rails server.
 ">
      <a tabindex="-1" href="/blog/2014/12/18/setting-up-an-api-on-an-existing-rails-application/">Setting Up An API On An &hellip;</a>
    </li>
    
    <li data-index="tictactoe in ruby this is a really quick ruby tictactoe program that really feels like it&amp;rsquo;s playing against you.
 ">
      <a tabindex="-1" href="/blog/2014/11/03/tictactoe-in-ruby/">Tictactoe in Ruby</a>
    </li>
    
    <li data-index="add comments to a octopress blog have you ever wanted to add comments to you github pages blog? it will take a quick two minutes and you&amp;rsquo;ll be ready for feedback!
 ">
      <a tabindex="-1" href="/blog/2014/10/28/add-comments-to-your-blog/">Add Comments To a &hellip;</a>
    </li>
    
    <li data-index="technical interviews, oh my! &amp;ldquo;repeat, clarify, make examples, pseudo-code, code, and finally run it&amp;rdquo;&amp;hellip;
 ">
      <a tabindex="-1" href="/blog/2014/09/22/technical-interviews/">Technical Interviews, Oh &hellip;</a>
    </li>
    
    <li data-index="an unexpected adventure: my flatiron experience this past summer i attended the flatiron school in new york city for their ruby summer intensive course.
 ">
      <a tabindex="-1" href="/blog/2014/09/04/an-unexpected-adventure/">An Unexpected Adventure &hellip;</a>
    </li>
    
    <li data-index="arrays of a feather flock together i have found that explaining programs (or trying to) has helped me greatly in understanding the use of syntax. so let me teach you about these little nuisances called nested arrays.
 ">
      <a tabindex="-1" href="/blog/2014/06/13/arrays-of-a-feather-flock-together/">Arrays of a Feather &hellip;</a>
    </li>
    
  </ul>
  
</form>
  
</div>
<ul class="nav main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="content" class="container">
    <article class="hentry span10 offset1" role="article">
  
  <header>
    
      
        
          
        
      
      
      <h1 class="entry-title">Setting Up an API on an Existing Rails Application</h1>
    
    
      <p class="meta">
        








  



<time datetime="2014-12-18T12:48:34-05:00" data-updated="true"></time>
      </p>
    
  </header>


<div class="entry-content lettrine"><p>Hey y&#8217;all it&rsquo;s been a long time! Life has been a bit busy at the moment and I&rsquo;ll write a blog all about that in the non-technical session ASAP.</p>

<p>Today I&rsquo;m going to talk about setting up your current Rails application with an API. This is assuming that you have a working Rails application, preferably with data to see in the browser when you have it up and running through the rails server.</p>

<!--more-->


<h2>The Pre-Coding Code</h2>

<p>So before we do any serious setup the first thing we will need to do is access the rails-api gem. To do this put this line inside your Gemfile file</p>

<figure class='code'><figcaption><span>[Gemfile] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem 'rails-api' , require: 'rails-api/action_controller/api'</span></code></pre></td></tr></table></div></figure>


<p>and bundle install.</p>

<h2>Ain&rsquo;t No Basic Controller</h2>

<p>At this point you will have access to the API Action Controller which I suggest you read up on in the <a href="http://api.rubyonrails.org/">Ruby on Rails API docs</a>. So now that your application is ready for API goodness you&rsquo;ll want to create a sub-folder underneath your <span font-style="italics">app/controllers</span> titled <span style="font-weight: 500"> api </a>.</p>

<p>At this point underneath <span font-style="italics">app/controllers</span> you should have your main controllers, ie. application_controller or user_controller, and your <span font-style="italics">api</span> folder.</p>

<p>Now inside this api folder you will want to add an <span font-style="italics">api_controller.rb</span> file and an optional <span font-style="italics">v1</span> folder.</p>

<p>The <span font-style="italics">api_controller.rb</span> will be your API controller, this is essentially the application controller for your API. Inside your api_controller you will want to set it up similarly to the application_controller <figure class='code'><figcaption><span>[api_controller.rb] </span></figcaption></p>

<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'>  <span class="k">class</span> <span class="nc">Api</span><span class="o">::</span><span class="no">ApiController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">API</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div>


<p></figure></p>

<p>As you can see we are no longer using the Base Action Controller, instead we&rsquo;re using the API Action Controller. This will be one of the sub controllers that will inherit from the Base Action Controller. If in the future you want to implement an API sign in option with a username and secret as many api&rsquo;s have now-a-days this if the file you would do this in.</p>

<p>At this point you should have the <span font-style="italics">api_controller.rb</span> setup and hopefully, but not required, the <span font-style="italics">v1</span> folder setup.</p>

<p>I suggest implement the <span font-style="italics">v1</span> folder incase you decide to create multiple versions of the api in the future.</p>

<p>So let&rsquo;s say you have the <span font-style="italics">v1</span> setup. Inside this folder you will have all of the controllers you&rsquo;re find in the main controllers folder. Currently I am using an api user_controller to allow api users to access the users in the system.</p>

<h2>Get The Data You Want</h2>

<p>Inside the <span font-style="italics">user_controller.rb</span> you will want to set it up depending on which information you want to be shown. Let&rsquo;s say that your application user_controller has both index and show methods, this will mean your API user_controller will also have index and show methods.</p>

<figure class='code'><figcaption><span>[api/v1/user_controller.rb]</span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'>  <span class="k">class</span> <span class="nc">Api</span><span class="o">::</span><span class="no">V1</span><span class="o">::</span><span class="no">UserController</span> <span class="o">&lt;</span> <span class="no">Api</span><span class="o">::</span><span class="no">ApiController</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">MimeResponds</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>      <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>        <span class="vi">@users</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">all</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">json</span><span class="p">:</span><span class="vi">@users</span> <span class="p">}</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">show</span>
</span><span class='line'>      <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>        <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">json</span><span class="p">:</span><span class="vi">@user</span> <span class="p">}</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here I have set it up so that when the api user goes to <span font-style="italics">example.com/api/v1/users.json</span> they will see all the users in the database. As you can see I put &ldquo;.json&rdquo; at the end of the html address, this is because inside the api user_controller I specified the format I want to respond to. I you wanted the api to respond to an xml call then you would put</p>

<figure class='code'><figcaption><span>[user_controller.rb] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'>  <span class="nb">format</span><span class="o">.</span><span class="n">xml</span> <span class="p">{</span><span class="n">render</span> <span class="ss">xml</span><span class="p">:</span><span class="vi">@user</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p> or even allowing access to both json and xml calls</p>

<p> <figure class='code'><figcaption><span>[user_controller.rb] </span></figcaption></p>

<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'>    <span class="k">if</span> <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="p">{</span><span class="n">render</span> <span class="ss">json</span><span class="p">:</span><span class="vi">@user</span><span class="p">}</span>
</span><span class='line'>    <span class="k">if</span> <span class="nb">format</span><span class="o">.</span><span class="n">xml</span> <span class="p">{</span><span class="n">render</span> <span class="ss">xml</span><span class="p">:</span><span class="vi">@user</span><span class="p">}</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div>


<p></figure></p>

<p> I setup the user.show api call similarly. When an api user calls <span font-style="italics">example.com/api/v1/users/1.json</span> this will show that specific user&rsquo;s data.</p>

<h2>Almost Done!!!</h2>

<p>Awesome, you&rsquo;re almost done. Just like any other controller you will need to set up the routes.</p>

<figure class='code'><figcaption><span>[config/routes.rb] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'>  <span class="n">namespace</span> <span class="ss">:api</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">namespace</span> <span class="ss">:v1</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">resources</span> <span class="ss">:user</span> <span class="k">do</span>
</span><span class='line'>        <span class="n">resources</span> <span class="ss">:other_controllers</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>I chose to organize my api groups of controllers under a namespace and again under a v1 namespace. This allows me to organize my routes instead of searching for them through the document. Optionally I chose to make my <span font-style="italics">api/user_controller.rb</span> also a namespace. This requires me to access my other api controllers based on the user api controller.</p>

<p>And that&rsquo;s it! You have successfully implemented your application with Rails API. Any advice or concerns are appreciated! &lt;3</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Christina Leuci</span></span>

      








  



<time datetime="2014-12-18T12:48:34-05:00" data-updated="true"></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/api/'>api</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>, <a class='category' href='/blog/categories/technical/'>technical</a>
  
</span>


    </p>
    <p class="meta">
      
        
          <a class="basic-alignment left" href="/blog/2014/11/03/tictactoe-in-ruby/" title="Previous Post: Tictactoe in Ruby">&larr;<span class="hide-mobile">&nbsp;Tictactoe in Ruby</span></a>
        
        
      
    </p>
  </footer>
	
	<section id="comments">
		<h1>Comments</h1>
		
		
		<div id="disqus_thread" aria-live="polite">
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

		</div>
		
	</section>
	
</article>

  </div>
  <footer role="contentinfo"><a rel="license" href="/license" class="CC">
  <img alt="Creative Commons License" src="/img/cc-by-nc-small.png">
</a>

<script src="/js/typo.js"></script>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'christinaleucigithubio';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://ChristinaLeuci.github.io/blog/2014/12/18/setting-up-an-api-on-an-existing-rails-application/';
        var disqus_url = 'http://ChristinaLeuci.github.io/blog/2014/12/18/setting-up-an-api-on-an-existing-rails-application/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>








</body>
</html>
